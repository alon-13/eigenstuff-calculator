<!DOCTYPE html>
<html lang="en">
<head>
    <title>Eigenstuff Calculator</title>
    <style>
        body { font-family: sans-serif; max-width: 600px; margin: 40px auto; padding: 20px; line-height: 1.6; }
        .matrix-grid { display: grid; gap: 5px; margin-bottom: 20px; }
        input { width: 50px; padding: 5px; text-align: center; }
        .result-item { background: #f4f4f4; padding: 10px; margin-top: 10px; border-radius: 5px; }
        button { padding: 10px 20px; cursor: pointer; background: #007bff; color: white; border: none; }
    </style>
</head>
<body>
    <h2>Eigenstuff Calculator</h2>
    <p>Select Size (n x n): 
        <select id="size" onchange="createGrid()">
            <option value="2">2x2</option>
            <option value="3">3x3</option>
            <option value="4">4x4</option>
            <option value="5">5x5</option>
        </select>
    </p>

    <div id="matrix-container" class="matrix-grid"></div>
    <button onclick="calculate()">Compute</button>

    <div id="results"></div>

    <script>
        function createGrid() {
            const size = document.getElementById('size').value;
            const container = document.getElementById('matrix-container');
            container.innerHTML = '';
            container.style.gridTemplateColumns = `repeat(${size}, 60px)`;
            
            for (let i = 0; i < size * size; i++) {
                const input = document.createElement('input');
                input.type = 'number';
                input.value = '0';
                input.className = 'matrix-input';
                container.appendChild(input);
            }
        }

        async function calculate() {
            const size = parseInt(document.getElementById('size').value);
            const inputs = document.querySelectorAll('.matrix-input');
            const matrix = [];
            
            // Convert flat list of inputs into 2D array
            for (let i = 0; i < size; i++) {
                const row = [];
                for (let j = 0; j < size; j++) {
                    row.push(parseFloat(inputs[i * size + j].value) || 0);
                }
                matrix.push(row);
            }

            try {
             // This will automatically point to whatever domain the page is hosted on
const response = await fetch('/compute', { 
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ matrix })
});
                });
                
                const data = await response.json();
                if (data.error) throw new Error(data.error);
                
                displayResults(data.results);
            } catch (err) {
                alert("Error: " + err.message);
            }
        }

        function displayResults(results) {
            const div = document.getElementById('results');
            div.innerHTML = '<h3>Results:</h3>';
            results.forEach((item, index) => {
                div.innerHTML += `
                    <div class="result-item">
                        <strong>Î»${index + 1}:</strong> ${item.eigenvalue} <br>
                        <strong>Basis Vector:</strong> [${item.eigenvector.join(', ')}]
                    </div>`;
            });
        }

        createGrid(); // Initialize
    </script>
</body>
</html>

